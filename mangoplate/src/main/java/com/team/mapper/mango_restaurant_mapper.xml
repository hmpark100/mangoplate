<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="mapper.restaurant">

	<!-- restaurant content-->
	<select id="content" parameterType="java.lang.String" resultType="com.mangoplate.vo.MangoRestVO">
		select mr.rid,rname,raddr,rcontact,rprice,rcategory,rdate,rhits,rcontent,rimage,rsimage
				from cgv_movie cm,cgv_movie_file cmf where cm.mid=cmf.mid and cm.mid=#{mid}
	</select>
	
	<!-- restautant list-->
	<select id="list" parameterType="map" resultType="com.mangoplate.vo.MangoRestVO">
		 select rno, rid, rcategory, rname, rdate
				from (select rownum rno, rid, rcategory, rname, rdate
				from (select rid, rcategory, rname, rdate from mg_restaurant order by rdate desc))
				where rno between #{start} and #{end}
	</select>
	
	<!-- movie totalcount-->
	<select id="totalcount" resultType="int">
		select count(*) from mg_restaurant
	</select>
	
	<!-- movie insertfile-->
	<insert id="insertfile" parameterType="com.mangoplate.vo.MangoRestVO">
		insert into mg_restaurant_file 
			values('f_'||sequ_cgv_movie_file.nextval,#{mfile1},#{msfile1},#{mfile2},#{msfile2},#{mid})
	</insert>
	
	<!-- restaurant select-->
	<select id="select" resultType="java.lang.String">
		select rid from 
			(select rid from mg_restaurant order by rdate desc) where rownum=1
	</select>
	
	<!-- restaurant insert-->
	<insert id="insert" parameterType="com.mangoplate.vo.MangoRestVO">
		insert into mg_restaurant 
			values('r_'||sequ_mg_restaurant.nextval,#{rname},#{raddr},#{rcontact},#{rprice},#{rcategory},sysdate,#{rhits},#{rcontact},#{rcontent},#{rimage},#{rsimage})
	</insert>
</mapper>